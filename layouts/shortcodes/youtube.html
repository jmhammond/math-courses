{{- $ytHost := "www.youtube-nocookie.com" -}}
{{- $id := .Get "id" | default (.Get 0) -}}
{{- $url := printf "https://youtube.com/watch?v=%v" $id -}}
{{- $request := print "https://youtube.com/oembed?" (querify "format" "json" "maxwidth" "1980" "maxheight" "1080" "url" $url) -}}
{{- $json := getJSON $request -}}
{{- $heightPct := div (mul 100.0 $json.height) $json.width -}}
{{- $class := .Get "class" | default (.Get 1) -}}
{{- $title := .Get "title" | default $json.title }}
<div {{ with $class }}class="{{ . }}"{{ else }}style="position: relative; padding-bottom: {{ $heightPct }}%; height: 0; overflow: hidden;"{{ end }}>
  <iframe src="https://{{ $ytHost }}/embed/{{ $id }}?rel=0&cc_load_policy=1{{ with .Get "autoplay" }}{{ if eq . "true" }}?autoplay=1{{ end }}{{ end }}" {{ if not $class }}style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" {{ end }} allow="fullscreen;" allowFullScreen="allowfullscreen" title="{{ $title }}"></iframe>
</div>